# 超越分库分表-高可用与读写分离

## 1.从单机到集群

单机MySQL 数据库的几个问题

1、容量有限，难以扩容
2、读写压力，QPS 过大，特别是分析类需求会影响到业务事务
3、可用性不足，宕机问题

## 2.MySQL 主从复制*

核心是
1、主库写binlog
2、从库relay log

主从复制在业务系统里的应用

借助于主从复制，我们现在有了多个MySQL 服务器示例。
如果借助这个新的集群，改进我们的业务系统数据处理能力？
== > 配置多个数据源，实现读写分离

## 3.MySQL 读写分离*


## 4.MySQL 高可用*

为什么要高可用
1、读写分离，提升读的处理能力
2、故障转移，提供failover 能力
加上业务侧连接池的心跳重试，实现断线重连，业务不间断，降低RTO 和RPO。

高可用意味着，更少的不可服务时间。一般用SLA/SLO衡量。
1年= 365天= 8760小时
99 = 8760 * 1% = 8760 * 0.01 = 87.6小时
99.9 = 8760 * 0.1% = 8760 * 0.001 = 8.76小时
99.99 = 8760 * 0.0001 = 0.876小时= 0.876 * 60 = 52.6分钟
99.999 = 8760 * 0.00001 = 0.0876小时= 0.0876 * 60 = 5.26分钟
后面的分布式课程讲稳定性，注意关系和区别。

什么是failover，故障转移，灾难恢复
容灾：热备与冷备
对于主从来说，简单讲就是主挂了，某一个从，变成主，
整个集群来看，正常对外提供服务
常见的一些策略：
1、多个实例不在一个主机/机架上
2、跨机房和可用区部署
3、两地三中心容灾高可用方案

MySQL 高可用0：主从手动切换
MySQL 高可用1：主从手动切换
MySQL 高可用2：MHA
MySQL 高可用3：MGR *
MySQL 高可用4：MySQL Cluster

## 5.总结回顾与作业实践